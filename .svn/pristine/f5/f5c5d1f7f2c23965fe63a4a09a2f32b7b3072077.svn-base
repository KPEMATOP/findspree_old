<?php
/**
 * Created by PhpStorm.
 * User: albert
 * Date: 15.03.15
 * Time: 19:15
 */

namespace common\widgets;


use ijackua\sharelinks\ShareLinks;
use yii\helpers\ArrayHelper;

class Share extends ShareLinks
{
	public $shareUrlMap = [
		self::SOCIAL_TWITTER   => 'https://twitter.com/intent/tweet?url={url}&text={title}&',
		self::SOCIAL_FACEBOOK  => 'https://www.facebook.com/sharer/sharer.php?s=100&p[url]={url}&p[title]={title}&p[summary]={description}&p[images][0]={image}',
		self::SOCIAL_VKONTAKTE => 'http://vk.com/share.php?url={url}&image={image}&title={title}&description={description}',
		self::SOCIAL_GPLUS     => 'https://plus.google.com/share?url={url}',
		self::SOCIAL_LINKEDIN  => 'http://www.linkedin.com/shareArticle?url={url}',
		self::SOCIAL_KINDLE    => 'http://fivefilters.org/kindle-it/send.php?url={url}'
	];
	public $title;
	public $description;
	public $image;

	public function init()
	{
		if(!$this->title)$this->title = \Yii::$app->view->title;
		parent::init(); // TODO: Change the autogenerated stub
	}

	public function shareUrl($networkId)
	{
		$network = ArrayHelper::getValue($this->shareUrlMap, $networkId);
		$search  = ['{url}','{title}','{description}','{image}'];
		$replace = [urlencode($this->url),$this->title,$this->description,$this->image];
		return str_replace($search, $replace, $network);
	}
}