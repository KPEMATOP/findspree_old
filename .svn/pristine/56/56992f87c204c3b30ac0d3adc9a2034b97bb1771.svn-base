<?php
/**
 * Created by PhpStorm.
 * User: Альберт
 * Date: 08.05.2015
 * Time: 3:04
 */

namespace common\social\OAuth2;


use nodge\eauth\services\GoogleOAuth2Service;

class Google extends GoogleOAuth2Service {
	protected function fetchAttributes()
	{
		$email = $this->makeSignedRequest('https://www.googleapis.com/plus/v1/people/me');
		print '<pre>'.print_r($email,1).'</pre>';
		$info = $this->makeSignedRequest('https://www.googleapis.com/oauth2/v1/userinfo');
		print '<pre>$this->attributes '.print_r($this->attributes,1).'</pre>';

		$this->attributes['id'] = $info['id'];
		$this->attributes['name'] = $info['name'];

		if (!empty($info['link'])) {
			$this->attributes['url'] = $info['link'];
		}

		/*if (!empty($info['gender']))
			$this->attributes['gender'] = $info['gender'] == 'male' ? 'M' : 'F';

		if (!empty($info['picture']))
			$this->attributes['photo'] = $info['picture'];

		$info['given_name']; // first name
		$info['family_name']; // last name
		$info['birthday']; // format: 0000-00-00
		$info['locale']; // format: en*/
		print '<pre>$this->attributes '.print_r($this->attributes,1).'</pre>';
		die;
	}
}