<?php
/* @var $this yii\web\View */
use common\helpers\String;
use common\models\User;
use yii\helpers\Url;

/* @var $userAuth User */
/* @var $userView User */
/* @var $eventSubscribe  \common\models\Event[] */
/* @var $eventCreate  \common\models\Event[] */
frontend\assets\User::register($this);
$isSubscribed = $userAuth ? $userView->isSubscribed($userAuth) : false;

?>
<div class="row">
    <div class="col-md-3 user-left col-md-offset-1">
        <div class="avatar-edit" style="overflow: hidden;position: relative">
            <?= $userView->getAvatar(User::AVATAR_240, ['class' => 'img-responsive user-avatar center-block img-circle ']); ?>
            <?php if($userView->isMy()): ?>
            <a href="<?= Url::to(['user/avatar-change'])?>" title="Сменить аватар" class="avatar-edit-click"><i class="md md-camera-alt md-5x"></i></a>
            <?php endif ?>
        </div>
        <div class="panel panel-default">
            <div class="panel-body">
                <?php if ($userView->isOnline()): ?>
                    <div class="md md-brightness-1 user-point-on pull-right" title="Онлайн" ></div>
                <?php else: ?>
                    <div class="md md-brightness-1 user-point-off pull-right" title="Оффлайн"></div>
                <?php endif ?>
                <h2><?= $userView->username?></h2>
            </div>
            <?php if (!$userView->isMy()): ?>
                <?php if ($isSubscribed): ?>
                    <div id="user-subscribe"
                         class="btn  btn-success btn-block"
                         data-remote="<?= Url::to(['user/subscribe', 'user_id' => $userView->id]); ?>">
                        <i class="md md-group"></i> <span>ВЫ ПОДПИСАНЫ</span>
                    </div>
                <?php else: ?>
                    <div id="user-subscribe"
                         class="btn  btn-info  btn-block"
                         data-remote="<?= Url::to(['user/subscribe', 'user_id' => $userView->id]); ?>">
                        <i class="md md-group"></i> <span>ПОДПИСАТЬСЯ</span>
                    </div>
                <?php endif ?>
            <?php endif; ?>
        </div>
        <div class="list-group">
            <a id="menu-wall" href="#" class="list-group-item menu-item" data-action="wall">
                Действия
            </a>
            <a id="menu-event-subscribe" href="#" class="list-group-item menu-item" data-action="eventSubscribe">
                Избранные события <span class="badge badge-default"><?= $userView->getEventSubscribe()->count()?></span>
            </a>
            <a id="menu-event-create" href="#" class="list-group-item menu-item" data-action="eventCreated">
                Созданные события <span class="badge badge-default"><?= $userView->getEventCreate()->count()?></span>
            </a>
            <a href="#" class="list-group-item menu-item" data-action="userSubscribe">
                Подписан на <span class="badge badge-default">2</span >
            </a>
            <a href="#" class="list-group-item menu-item" data-action="userSubscribers">
                Подписчики <span class="badge badge-default">123</span>
            </a>
        </div>
    </div>
    <div id="content" class="col-md-7">
        <div id="act-wall" class="panel-default act" style="display: none"
             data-remote="<?= Url::to(['/user/wall', 'id' => $userView->id]); ?>">
            <div class="panel-heading">
                Действия <span class="counter"></span>
            </div>
            <div class="panel-body row"></div>
            <div class="text-center panel-empty  panel-next-page">
                <i class="md md-sync md-loop md-spin-reverse md-3x" style="display: none"></i>
                <i class="md md-event-note md-3x"></i>
            </div>
            <div class="panel-footer panel-next-page"><i class="md md-more-horiz"></i></div>
        </div>
        <div id="act-event-subscribe" class="panel panel-default act"
             data-remote="<?= Url::to(['/user/events-subscribe', 'id' => $userView->id]); ?>">
            <div class="panel-heading">
                Подписан на события <span class="counter"></span>
            </div>
            <div class="panel-body"></div>
            <div class="text-center panel-empty  panel-next-page">
                <i class="md md-sync md-loop md-spin-reverse md-3x" style="display: none"></i>
                <i class="md md-event-note md-3x"></i>
            </div>
            <div class="panel-footer panel-next-page"><i class="md md-more-horiz"></i></div>
        </div>
        <div id="act-event-create" class="panel panel-default act"
             data-remote="<?= Url::to(['/user/events-created', 'id' => $userView->id]); ?>">
            <div class="panel-heading">
                Созданные события <span class="counter"></span>
            </div>
            <div class="panel-body"></div>
            <div class="text-center panel-empty  panel-next-page">
                <i class="md md-sync md-loop md-spin-reverse md-3x" style="display: none"></i>
                <i class="md md-event-note md-3x"></i>
            </div>
            <div class="panel-footer panel-next-page"><i class="md md-more-horiz"></i></div>
        </div>
        <div id="act-userSubscribe" class="panel panel-default act" style="display: none"
             data-remote="<?= Url::to(['/user/event-list-subscribe', 'id' => $userView->id]); ?>">
            <div class="panel-heading">
                Подписанный на пользователей <span class="counter"></span>
            </div>
            <div class="panel-body-fake">
            </div>
            <div class="text-center panel-empty  panel-next-page">
                <i class="md md-sync md-loop md-spin-reverse md-3x" style="display: none"></i>
                <i class="md md-event-note md-3x"></i>
            </div>
            <div class="panel-footer panel-next-page"><i class="md md-more-horiz"></i></div>
        </div>
        <div id="act-userSubscribers" class="panel panel-default act"
             data-remote="<?= Url::to(['/user/event-list-subscribe', 'id' => $userView->id]); ?>">
            <div class="panel-heading">
                Подписчики <span class="counter"></span>
            </div>
            <div class="panel-body-fake">
            </div>
            <div class="text-center panel-empty  panel-next-page">
                <i class="md md-sync md-loop md-spin-reverse md-3x" style="display: none"></i>
                <i class="md md-event-note md-3x"></i>
            </div>
            <div class="panel-footer panel-next-page"><i class="md md-more-horiz"></i></div>
        </div>
    </div>
</div>


<script id="tpl-event-wide" type="text/html">
    <?= $this->renderFile('@app/views/tpl/event-line.php'); ?>
</script>
<script id="tpl-wall-new-event" type="text/html">
    <?= $this->renderFile('@app/views/tpl/wall-new-event.php'); ?>
</script>
<script id="tpl-wall-subscribe-event" type="text/html">
    <?= $this->renderFile('@app/views/tpl/wall-subscribe-event.php'); ?>
</script>
<script id="tpl-wall-subscribe-user" type="text/html">
    <?= $this->renderFile('@app/views/tpl/wall-subscribe-user.php'); ?>
</script>